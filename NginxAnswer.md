## Nginx问题

### 请解释一下什么是Nginx
```
是一款免费的、自由的、开源的、高性能HTTP服务器和反向代理服务器;
是一个IMAP、POP3、SMTP代理服务器;
Nginx以其高性能、稳定性、丰富的功能、简单的配置和低资源消耗而闻名;

Nginx 解决了服务器的C10K(就是在一秒之内连接客户端的数目为10k即1万)问题。它的设计不像传统的服务器那样使用线程处理请求，而是一个更加高级的机制—事件驱动机制，是一种异步事件驱动结构。
```

### 2.请列举Nginx的一些特性
- 跨平台:可以在大多数Unix like系统编译运行。而且也有Windows的移植版本
- 配置异常简单:非常的简单,易上手。
- 非阻塞、高并发连接:数据复制时,磁盘I/O 的第一阶段是非阻塞的。官方测试能能支持5万并发连接,实际胜场中能跑2~3万并发连接数（得益于Nginx采用了最新的epoll事件处理模型（消息队列）。
- Nginx接收用户请求是一步的，即先将用户请求全部接下来，在一次性发送到后端Web服务器，极大减轻后端Web服务器的压力。
- 发送响应报文时，是边接收来自后端Web服务器的数据，便发送给客户端。
- Nginx代理和后端Web服务器件无需长连接
- 网络依赖性低，理论上只要能够ping通就可以实施负载均衡，而且可以有效区分内网、外网流量。
- 支持内置服务器检测。Nginx能够根据应用服务器处理页面返回的状态码、超时信息等检测服务器是否出现故障，并及时返回错误的请求重新提交到其它节点上。
- 此外还有内存消耗小、成本低廉（比F5硬件负载均衡器廉价太多）、节省带宽、稳定性高等特点。


### 请列举Nginx和Apache 之间的不同点
![](https://img2018.cnblogs.com/blog/1231979/201911/1231979-20191113094447975-1458045959.png)


### 请解释Nginx如何处理HTTP请求。
Nginx是一个高性能的Web服务器,能够同事处理大量的并发请求.它结合多进程机制和异步非阻塞机制。

#### 多进程机制
服务器每收到一个客户端时，就有服务器主进程(master process)生成一个子进程（work process）出来和客户端建立连接进行交互，直到连接断开，该子进程就结束了


使用进程的好处是各个进程之间相互独立，不需要加锁，减少了使用锁对性能造成影响，同时降低编程的复杂度降低开发成本。其次，采用独立的进程，可以让进程互相之间不会影响 ，如果一个进程发生异常退出时，其它进程正常工作， master 进程则很快启动新的 worker 进程，确保服务不会中断，从而将风险降到最低。

缺点是操作系统生成一个子进程需要进行 内存复制等操作，在资源和时间上会产生一定的开销。当有大量请求时，会导致系统性能下降 。


#### 异步非阻塞机制
每个工作进程使用异步非阻塞方式，可以处理多个客户端请求。

当某个工作进程接收到客户端的请求以后，调用IO进行处理，如果不能立即得到结果，就去处理其他请求（即为非阻塞）；而客户端在此期间也无需等待响应，可去处理其他事情（即为异步）


当 IO 返回时，就会通知此 工作进程 ；该进程得到通知，暂时 挂起 当前处理的事务去 响应客户端请求 。


### 5、在Nginx中，如何使用未定义的服务器名称来阻止处理请求?

只需将请求删除的服务器就可以定义为：

![](https://img2018.cnblogs.com/blog/1231979/201911/1231979-20191113095243865-1960719059.png)

这里，服务器名被保留为一个空字符串，它将在没有“主机”头字段的情况下匹配请求，而一个特殊的Nginx的非标准代码444被返回，从而终止连接。



### 6、 使用“反向代理服务器”的优点是什么?
反向代理服务器可以隐藏源服务器的存在和特征。它充当互联网云和web服务器之间的中间层，这对于安全方面来说是很好的，特别是当使用web托管服务时。



### 7、请列举Nginx服务器的最佳用途。
Nginx服务器的最佳用法是在网络上部署动态HTTP内容，使用SCGI、WSGI应用程序服务器、用于脚本的FastCGI处理程序。它还可以作为负载均衡器。


### 8、请解释Nginx服务器上的Master和Worker进程分别是什么?

- 主程序 Master process 启动后，通过一个 for 循环来 接收 和 处理外部信号 ；
- 主进程通过 fork() 函数产生 worker 子进程 ，每个子进程执行一个 for循环来实现Nginx服务器对事件的接收和处理 。

![](https://img2018.cnblogs.com/blog/1231979/201911/1231979-20191113095530816-153355520.png)
